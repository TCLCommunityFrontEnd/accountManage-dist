(window.webpackJsonp=window.webpackJsonp||[]).push([["routerManage"],{"./src/ts/pages/RouterManage/index.tsx":function(e,t,n){"use strict";n.r(t);var a=n("react"),r=n.n(a),l=n("./node_modules/antd/es/form/index.js"),o=n("./node_modules/antd/es/space/index.js"),i=n("./node_modules/antd/es/button/index.js"),s=n("./node_modules/antd/es/switch/index.js"),c=n("./node_modules/antd/es/divider/index.js"),u=n("./node_modules/antd/es/popconfirm/index.js"),d=n("./src/ts/components/ExFormItem.tsx"),m=n("./node_modules/react-redux/es/index.js"),f=n("./node_modules/antd/es/form/hooks/useForm.js"),E=n("./src/ts/config/api.ts"),O=n("./src/ts/utils/http.js"),p=n("./src/ts/config/const.ts"),A=n("./node_modules/antd/es/message/index.js"),g=function(){return(g=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},h={singleBaseUrl:E.a.baseUrl2},R={getList:function(){return function(e,t){var n=t().routerManage.searchParams;return e({type:"ROUTERMANAGE_LOADING",loading:!0}),O.a.get(p.a.GET_ROUTER_LIST,n,h).then(function(t){var n=t.map(function(e){return g(g({},e),{serviceName:e.serviceId})});e({type:"ROUTERMANAGE_LISTDATA",data:n})}).finally(function(){return e({type:"ROUTERMANAGE_LOADING",loading:!1})})}},handleSave:function(e){return function(t,n){var a=e.id?p.a.UPDATE_ROUTER:p.a.CREATE_ROUTER;return t({type:"ROUTERMANAGE_MODAL_CONFIRM_LOADING",loading:!0}),O.a.post(a,e,h).then(function(){A.b.success("Success"),t({type:"ROUTERMANAGE_MODAL_SHOW",show:!1}),t(R.getList())}).finally(function(){return t({type:"ROUTERMANAGE_MODAL_CONFIRM_LOADING",loading:!1})})}},handleDel:function(e){return function(t,n){var a=n().routerManage.searchParams,r={id:e,region:a.region};return t({type:"ROUTERMANAGE_LOADING",loading:!0}),O.a.post(p.a.DEL_ROUTER,r,h).then(function(){A.b.success("Success"),t(R.getList())}).finally(function(){return t({type:"ROUTERMANAGE_MODAL_CONFIRM_LOADING",loading:!1})})}}},y=R,_=n("./src/ts/components/ExTable.tsx"),b=n("./src/ts/components/ExModal.tsx"),M=(n("./src/less/routerManage.less"),function(){return(M=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),N=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,l=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=l.next()).done;)o.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},v=function(){var e=Object(m.d)(function(e){return e.routerManage}),t=e.modalShow,n=e.modalInfo,o=e.searchParams,i=e.regionOpts,s=Object(m.c)(),c=N(Object(f.a)(),1)[0];return Object(a.useEffect)(function(){c&&t&&(c.resetFields(),c.setFieldsValue(n),c.setFieldsValue({region:o.region}))},[c,t,n,o]),r.a.createElement(b.a,{title:n.id?"编辑":"新增",visible:t,onOk:function(){s(y.handleSave(c.getFieldsValue()))},onCancel:function(){s({type:"ROUTERMANAGE_MODAL_SHOW",show:!1})}},r.a.createElement(l.a,{form:c,labelCol:{flex:"0 0 100px"}},r.a.createElement(d.a,{type:"hidden",name:"id"}),r.a.createElement(d.a,{label:"Region",name:"region",type:"select",list:i,disabled:!0}),r.a.createElement(d.a,{label:"Path",name:"path",required:!0,noClear:!0}),r.a.createElement(d.a,{label:"SerivceName",name:"serviceName"}),r.a.createElement(d.a,{label:"Url",name:"url"})))},T=function(){var e=N(Object(f.a)(),1)[0],t=Object(m.c)(),n=Object(m.d)(function(e){return e.routerManage}),a=n.regionOpts,s=n.searchParams;return r.a.createElement(l.a,{className:"search-form",style:{width:"100%"},form:e,layout:"inline",initialValues:s},r.a.createElement(d.a,{list:a,name:"region",label:"Region",type:"select",noClear:!0,style:{width:200}}),r.a.createElement(d.a,{name:"serviceName",label:"serviceName"}),r.a.createElement(l.a.Item,{style:{flex:1,textAlign:"right"}},r.a.createElement(o.b,null,r.a.createElement(i.a,{onClick:function(){t({type:"ROUTERMANAGE_MODAL_INFO",info:{}}),t({type:"ROUTERMANAGE_MODAL_SHOW",show:!0})}},"Create"),r.a.createElement(i.a,{type:"primary",onClick:function(){t({type:"ROUTERMANAGE_SEARCHPARAMS",data:e.getFieldsValue()}),t(y.getList())}},"Search"))))};t.default=function(){var e=Object(m.c)(),t=Object(m.d)(function(e){return e.routerManage}),n=t.listData,l=t.listLoading,o=t.searchParams,i=[{title:"Path",dataIndex:"path"},{title:"ServerName",dataIndex:"serviceName",render:function(e){return e||"-"}},{title:"Url",dataIndex:"url",render:function(e){return e||"-"}},{title:"Enabled",render:function(e,t){return r.a.createElement(s.a,{onChange:function(e){return f(t,e)},checkedChildren:"开启",unCheckedChildren:"关闭",checked:t.enabled})}},{title:"Actions",render:function(e,t){return r.a.createElement("span",null,r.a.createElement("a",{type:"link",onClick:function(){return d(t)}},"编辑"),r.a.createElement(c.a,{type:"vertical"}),r.a.createElement(u.a,{title:"Are you sure to delete item ?",onConfirm:function(){return E(t)}},r.a.createElement("a",null,"删除")))}}],d=function(t){e({type:"ROUTERMANAGE_MODAL_INFO",info:t}),e({type:"ROUTERMANAGE_MODAL_SHOW",show:!0})},f=function(t,n){var a=M({},t);a.region=o.region,a.enabled=n,e({type:"ROUTERMANAGE_LOADING",loading:!0}),e(y.handleSave(a))},E=function(t){e(y.handleDel(t.id))};return Object(a.useEffect)(function(){e(y.getList())},[]),r.a.createElement("div",{className:"page-router-manage"},r.a.createElement(T,null),r.a.createElement(_.a,{columns:i,dataCount:n.length,dataSource:n,loading:l,className:"table"}),r.a.createElement(v,null))}}}]);